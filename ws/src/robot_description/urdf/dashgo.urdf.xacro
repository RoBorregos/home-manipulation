<?xml version='1.0' encoding='utf-8'?>
<robot xmlns:xacro="http://ros.org/wiki/xacro" name="dashgo">
  
  <virtual_joint child_link="base_link" name="world_joint" parent_frame="base_footprint" type="planar" />
  
  <link name="base_footprint" />

  <joint name="base_footprint_joint" type="fixed">
    <origin xyz="0 0 0.1" rpy="0 0 0" />
    <parent link="base_footprint" />
    <child link="base_link" />
  </joint>

  <link name="base_link" />


  <joint name="base_link_joint" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0" />
    <parent link="base_link" />
    <child link="Base" />
  </joint>

  
  <!-- <link name="apriltag" />
  <joint name="apriltag_joint" type="fixed">
    <origin xyz="0.06 0 0.06" rpy="3.14 -1.57 0" />
    <parent link="BaseBrazo" />
    <child link="apriltag" />
  </joint> -->
  

  <link name="Base">
  

    <inertial>
      <origin xyz="-0.0421641375528847 0.0262460783517876 0.278949374295985" rpy="0 0 0" />
      <mass value="99.7355250620724" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Base.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/dashgo_cubierta_colliders.stl" />
      </geometry>
    </collision>
  </link>
  <link name="Llanta1">
  

    <inertial>
      <origin xyz="4.02455846426619E-16 6.59194920871187E-16 0.0200000000000003" rpy="0 0 0" />
      <mass value="0.528918539158378" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Llanta1.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Llanta1.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="Llanta1Cont" type="continuous">
    <origin xyz="-0.075244 0.166 0.0375" rpy="1.5708 0 3.1416" />
    <parent link="Base" />
    <child link="Llanta1" />
    <axis xyz="0 0 -1" />
  </joint>
  <link name="Llanta2">
  

    <inertial>
      <origin xyz="-1.38777878078145E-17 -1.11022302462516E-16 -0.02" rpy="0 0 0" />
      <mass value="0.528918539158378" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Llanta2.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Llanta2.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="Llanta2Cont" type="continuous">
    <origin xyz="-0.075244 -0.166 0.0375" rpy="1.5708 0 3.1416" />
    <parent link="Base" />
    <child link="Llanta2" />
    <axis xyz="0 0 -1" />
  </joint>
  <link name="Loca1">
  

    <inertial>
      <origin xyz="0 0.0345546529721542 -2.77555756156289E-17" rpy="0 0 0" />
      <mass value="0.0167352759899297" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Loca1.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Loca1.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="Loca1Cont" type="continuous">
    <origin xyz="0.11226 0.09 0.0025837" rpy="1.5708 0 -3.1152" />
    <parent link="Base" />
    <child link="Loca1" />
    <axis xyz="0 0 1" />
  </joint>
  <link name="LlantaLoca1">
  

    <inertial>
      <origin xyz="1.38777878078145E-17 -0.00741632050454701 1.38777878078145E-17" rpy="0 0 0" />
      <mass value="0.0694291976443344" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/LlantaLoca1.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/LlantaLoca1.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="LlantaLoca1Cont" type="continuous">
    <origin xyz="0 0 0" rpy="0 0 0" />
    <parent link="Loca1" />
    <child link="LlantaLoca1" />
    <axis xyz="0 0 1" />
  </joint>
  <link name="Loca2">
  

    <inertial>
      <origin xyz="0 0.0345546529721542 2.77555756156289E-17" rpy="0 0 0" />
      <mass value="0.0167352759899297" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Loca2.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Loca2.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="Loca2Cont" type="continuous">
    <origin xyz="0.11226 -0.09 0.0025837" rpy="1.5708 0 -3.1152" />
    <parent link="Base" />
    <child link="Loca2" />
    <axis xyz="0 0 1" />
  </joint>
  <link name="LlantaLoca2">
  

    <inertial>
      <origin xyz="0 -0.00469061857919597 -0.00574455456677592" rpy="0 0 0" />
      <mass value="0.0694291976443344" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/LlantaLoca2.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/LlantaLoca2.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="LlantaLoca2Cont" type="continuous">
    <origin xyz="0 0 0" rpy="0 0 0" />
    <parent link="Loca2" />
    <child link="LlantaLoca2" />
    <axis xyz="0 0 1" />
  </joint>
  <link name="Lidar">
  

    <inertial>
      <origin xyz="-9.49517221724887E-50 0.0125 -1.38777878078145E-17" rpy="0 0 0" />
      <mass value="0.0962112750161874" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Lidar.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/Lidar.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="Lidar1Cont" type="fixed">
    <origin xyz="0.15026 0 0.1325" rpy="0 0 0" />
    <parent link="Base" />
    <child link="Lidar" />
    <axis xyz="0 1 0" />
  </joint>


  <link name="BaseBrazo">
  

    <inertial>
      <origin xyz="-3.80430852558273E-17 -6.24500451351651E-17 -5.000000000005E-05" rpy="0 0 0" />
      <mass value="0.00121022002997899" />
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/BaseBrazo.STL" />
      </geometry>
      <material name="">
        <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://robot_description/meshes/Dashgo/BaseBrazo.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="basebrazo_joint" type="fixed">
    <origin xyz="-0.0055 0 0.458" rpy="0 0 1.57" />
    <parent link="Base" />
    <child link="BaseBrazo" />
    <axis xyz="0 0 0" />
  </joint>

<!-- these are needed-->
  <!-- <arg name="limited" default="false" doc="If true, limits joint range [-PI, PI] on all joints." />
  <arg name="add_gripper" default="false" doc="If true, will attach xarm_gripper from UFACTORY to the end" />
  <arg name="add_vacuum_gripper" default="false" doc="If true, will attach xarm_vacuum_gripper from UFACTORY to the end" />
  <arg name="robot_type" default="xarm" />
  <arg name="model1300" default="false" doc="load the new tool end model" />
  <arg name="add_realsense_d435i" default="false" />
  <arg name="add_d435i_links" default="false" />
  <arg name="robot_sn" default="" />
   -->

   <xacro:arg name="prefix" default=""/>
   <xacro:arg name="hw_ns" default="xarm"/>
   <xacro:arg name="limited" default="false"/>
   <xacro:arg name="effort_control" default="false"/>
   <xacro:arg name="velocity_control" default="false"/>
   <xacro:arg name="add_gripper" default="false"/>
   <xacro:arg name="add_vacuum_gripper" default="false"/>
   <xacro:arg name="model1300" default="false"/>
   
   <xacro:arg name="dof" default="6"/>
   <xacro:arg name="robot_ip" default=""/>
   <xacro:arg name="robot_type" default="xarm"/>
   <xacro:arg name="robot_sn" default=""/>
   <xacro:arg name="report_type" default="normal"/>
 
   <xacro:arg name="ros2_control_plugin" default="uf_robot_hardware/UFRobotSystemHardware"/>
   <xacro:arg name="ros2_control_params" default=""/>
 
   <xacro:arg name="add_realsense_d435i" default="false"/>
   <xacro:arg name="add_d435i_links" default="true"/>
   <xacro:arg name="use_gazebo_camera" default="false"/>
 
   <xacro:arg name="add_other_geometry" default="false"/>
   <xacro:arg name="geometry_type" default="box"/>
   <xacro:arg name="geometry_mass" default="0.1"/>
   <xacro:arg name="geometry_height" default="0.1"/>
   <xacro:arg name="geometry_radius" default="0.1"/>
   <xacro:arg name="geometry_length" default="0.1"/>
   <xacro:arg name="geometry_width" default="0.1"/>
   <xacro:arg name="geometry_mesh_filename" default=""/>
   <xacro:arg name="geometry_mesh_origin_xyz" default="0 0 0"/>
   <xacro:arg name="geometry_mesh_origin_rpy" default="0 0 0"/>
   <xacro:arg name="geometry_mesh_tcp_xyz" default="0 0 0"/>
   <xacro:arg name="geometry_mesh_tcp_rpy" default="0 0 0"/>
 
   <xacro:arg name="baud_checkset" default="true"/>
   <xacro:arg name="default_gripper_baud" default="2000000"/>
   
   <xacro:arg name="attach_to" default="BaseBrazo"/>
   <xacro:arg name="attach_xyz" default="0 0 0"/>
   <xacro:arg name="attach_rpy" default="0 0 0"/>
   <xacro:arg name="mesh_suffix" default="stl"/>
 
   <xacro:arg name="kinematics_suffix" default=""/>
  
  <xacro:include filename="$(find xarm_description)/urdf/xarm_device_macro.xacro" />
  <xacro:xarm_device prefix="$(arg prefix)" hw_ns="$(arg hw_ns)" limited="$(arg limited)" 
    effort_control="$(arg effort_control)" velocity_control="$(arg velocity_control)"
    add_gripper="$(arg add_gripper)" add_vacuum_gripper="$(arg add_vacuum_gripper)" dof="$(arg dof)" 
    ros2_control_plugin="$(arg ros2_control_plugin)" robot_type="$(arg robot_type)" 
    load_gazebo_plugin="true" ros2_control_params="$(arg ros2_control_params)"
    add_realsense_d435i="$(arg add_realsense_d435i)" 
    add_d435i_links="$(arg add_d435i_links)" 
    add_other_geometry="$(arg add_other_geometry)" 
    geometry_type="$(arg geometry_type)" geometry_mass="$(arg geometry_mass)"
    geometry_height="$(arg geometry_height)" geometry_radius="$(arg geometry_radius)"
    geometry_length="$(arg geometry_length)" geometry_width="$(arg geometry_width)"
    geometry_mesh_filename="$(arg geometry_mesh_filename)"
    geometry_mesh_origin_xyz="$(arg geometry_mesh_origin_xyz)" geometry_mesh_origin_rpy="$(arg geometry_mesh_origin_rpy)"
    geometry_mesh_tcp_xyz="$(arg geometry_mesh_tcp_xyz)" geometry_mesh_tcp_rpy="$(arg geometry_mesh_tcp_rpy)"
    robot_ip="$(arg robot_ip)" report_type="$(arg report_type)"
    baud_checkset="$(arg baud_checkset)" default_gripper_baud="$(arg default_gripper_baud)"
    model1300="$(arg model1300)" attach_to="$(arg attach_to)" attach_xyz="$(arg attach_xyz)" attach_rpy="$(arg attach_rpy)"
    robot_sn="$(arg robot_sn)" use_gazebo_camera="$(arg use_gazebo_camera)" mesh_suffix="$(arg mesh_suffix)" kinematics_suffix="$(arg kinematics_suffix)" />
  <xacro:include filename="$(find robot_description)/urdf/gripper/gripper.urdf.xacro" />
  <xacro:include filename="$(find robot_description)/urdf/gripper/gripperP.urdf.xacro" />
  <xacro:include filename="$(find robot_description)/urdf/gripper/gripperFakeSF.urdf.xacro" />
  <xacro:include filename="$(find robot_description)/urdf/gripper/gripperSF.urdf.xacro" />
  
  <xacro:load_gripperSF attach_to="$(arg prefix)link_eef" xyz="0 0 0.007" rpy="-1.57 0 2.3554" />
  
  <xacro:include filename="$(find robot_description)/urdf/camera.urdf.xacro" />
  
  <xacro:load_camera name="Cam1" attach_to="Base_Gripper" x="0.068098" y="-0.035446" z="0.0" r_p="-0.785398" r_r="1.5707" r_y="0.0" />
  <!-- <xacro:load_camera name="Cam2" attach_to="Base" x="-0.085" y="-0.24" z="0.48" r_r="0.538132" r_p="0" r_y="-1.5708" /> -->

  <!-- OakD Pro Camera -->
  <xacro:arg name="add_oakd1" default="true" />
  <xacro:arg name="oakd1_camera_name"   default="oakd-pro" />
  <xacro:arg name="oakd1_camera_model"  default="OAK-D-PRO" />
  <xacro:arg name="oakd1_base_frame"    default="oak-d_frame" />
  <xacro:arg name="oakd1_parent_frame"  default="Base" />
  <xacro:arg name="oakd1_cam_pos_x"     default="0.087710857" />
  <xacro:arg name="oakd1_cam_pos_y"     default="0.000295007" />
  <xacro:arg name="oakd1_cam_pos_z"     default="0.555560656" />
  <xacro:arg name="oakd1_cam_roll"      default="0.0" />
  <xacro:arg name="oakd1_cam_pitch"     default="0.0" />
  <xacro:arg name="oakd1_cam_yaw"       default="0.0" />

  <xacro:include filename="$(find robot_description)/urdf/include/depthai_macro.urdf.xacro"/>
  <xacro:if value="$(arg add_oakd1)">
    <xacro:depthai_camera camera_name="$(arg oakd1_camera_name)" parent="$(arg oakd1_parent_frame)" camera_model="$(arg oakd1_camera_model)" base_frame="$(arg oakd1_base_frame)" cam_pos_x="$(arg oakd1_cam_pos_x)" cam_pos_y="$(arg oakd1_cam_pos_y)" cam_pos_z="$(arg oakd1_cam_pos_z)" cam_roll="$(arg oakd1_cam_roll)" cam_pitch="$(arg oakd1_cam_pitch)" cam_yaw="$(arg oakd1_cam_yaw)" />
  </xacro:if>

  <gazebo>
    <plugin name="object_controller" filename="libgazebo_ros_planar_move.so">
      <commandTopic>cmd_vel</commandTopic>
      <odometryTopic>odom</odometryTopic>
      <odometryFrame>odom</odometryFrame>
      <odometryRate>20.0</odometryRate>
      <robotBaseFrame>base_footprint</robotBaseFrame>
    </plugin>
  </gazebo>

   <!-- hokuyo -->
   <gazebo reference="Lidar">
    <sensor type="gpu_ray" name="head_hokuyo_sensor">
      <pose>0 0 0 0 0 0</pose>
      <visualize>true</visualize>
      <update_rate>40</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>720</samples>
            <resolution>1</resolution>
            <min_angle>-3.1416</min_angle>
            <max_angle>3.1416</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.4</min>
          <max>30.0</max>
          <resolution>0.01</resolution>
        </range>
        <noise>
          <type>gaussian</type>
          <!-- Noise parameters based on published spec for Hokuyo laser
               achieving "+-30mm" accuracy at range < 10m.  A mean of 0.0m and
               stddev of 0.01m will put 99.7% of samples within 0.03m of the true
               reading. -->
          <mean>0.0</mean>
          <stddev>0.01</stddev>
        </noise>
      </ray>
      <plugin name="gazebo_ros_head_hokuyo_controller" filename="libgazebo_ros_gpu_laser.so">
        <topicName>scan</topicName>
        <frameName>Base</frameName>
      </plugin>
    </sensor>
  </gazebo>

  <gazebo reference="base_footprint">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="base_link">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Base">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Llanta1">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Llanta2">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Loca1">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="LlantaLoca1">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Loca2">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="LlantaLoca2">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Lidar">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="BaseBrazo">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Cam1">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  <gazebo reference="Lidar">
    <selfCollide>false</selfCollide>
    <gravity>0</gravity>
  </gazebo>
  
</robot>